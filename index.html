<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gestão Financeira Pessoal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/styles.css" />
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="apple-touch-icon" href="/assets/icons/apple-touch-icon.png">
    <meta name="theme-color" content="#3b5b70">
    <!-- Chart.js via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  </head>
  <body>
    <div class="layout">
      <aside class="sidebar">
        <div class="logo">FinançasPro</div>
        <nav class="nav">
          <a href="#/dashboard" data-route="dashboard" class="nav-link active">Dashboard</a>
          <a href="#/transactions" data-route="transactions" class="nav-link">Transações</a>
          <a href="#/categories" data-route="categories" class="nav-link">Categorias</a>
          <a href="#/banks" data-route="banks" class="nav-link">Bancos</a>
          <a href="#/goals" data-route="goals" class="nav-link">Metas</a>
        </nav>
      </aside>

      <div class="content">
        <header class="header">
          <div class="header-left">
            <div class="header-controls">
              <button id="btn-menu" class="btn-menu" aria-label="Menu">☰</button>
            </div>
            <div class="header-title">
              <h1 id="page-title">Dashboard</h1>
            </div>
          </div>

        </header>

        <main class="page-container">
          <!-- Dashboard -->
          <section id="page-dashboard" class="page">
            <div class="card">
              <h2 class="card-title">Meta Mensal de Gastos</h2>
              <div class="progress">
                <div class="progress-bar">
                  <div id="progress-fill" class="progress-fill" style="width:0%"></div>
                </div>
                <div class="progress-text">
                  <span id="progress-spent">Gasto: R$ 0,00</span>
                  <span id="progress-goal">Meta: R$ 0,00</span>
                </div>
                <div class="progress-text">
                  <span id="progress-percent">Progresso: 0%</span>
                  <span id="progress-warning" class="warning" hidden></span>
                </div>
              </div>
            </div>

            <div class="dashboard-grid-charts">
              <div class="card">
                <h2 class="card-title">Despesas por Categoria</h2>
                <div class="chart-square">
                  <canvas id="pie-expenses-by-category"></canvas>
                </div>
                <div id="pie-info" class="chart-info"></div>
              </div>
              <div class="card">
                <h2 class="card-title">Despesas por Banco</h2>
                <div class="chart-square">
                  <canvas id="pie-expenses-by-bank"></canvas>
                </div>
                <div id="pie-info-banks" class="chart-info"></div>
              </div>
            </div>
          </section>

          <!-- Transações -->
          <section id="page-transactions" class="page hidden">
            <div class="card">
              <h2 class="card-title">Nova Transação</h2>
              <form id="form-transaction" class="form-grid">
                <div class="form-group">
                  <label for="tx-description">Descrição</label>
                  <input id="tx-description" name="description" type="text" required />
                </div>
                <div class="form-group">
                  <label for="tx-amount">Valor (R$)</label>
                  <input id="tx-amount" name="amount" type="number" min="0.01" step="0.01" required />
                </div>
                <div class="form-group">
                  <label for="tx-date">Data</label>
                  <input id="tx-date" name="date" type="date" required />
                </div>
                <div class="form-group">
                  <label for="tx-type">Tipo</label>
                  <select id="tx-type" name="type" required>
                    <option value="expense">Despesa</option>
                    <option value="income">Receita</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="tx-category">Categoria</label>
                  <select id="tx-category" name="categoryId" required></select>
                </div>
                <div class="form-group" id="tx-bank-group">
                  <label for="tx-bank">Banco</label>
                  <select id="tx-bank" name="bankId"></select>
                </div>
                <div class="form-group form-actions">
                  <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
              </form>
            </div>

            <div class="card">
              <h2 class="card-title">Transações do Mês Atual</h2>
              <table class="table">
                <thead>
                  <tr>
                    <th>Data</th>
                    <th>Descrição</th>
                    <th>Categoria</th>
                    <th>Banco</th>
                    <th>Valor</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody id="table-transactions"></tbody>
              </table>
            </div>
          </section>

          <!-- Categorias -->
          <section id="page-categories" class="page hidden">
            <div class="card">
              <h2 class="card-title">Nova Categoria</h2>
              <form id="form-category" class="form-grid small">
                <div class="form-group">
                  <label for="cat-name">Nome</label>
                  <input id="cat-name" name="name" type="text" required />
                </div>
                <div class="form-group">
                  <label for="cat-color">Cor</label>
                  <input id="cat-color" name="color" type="color" value="#6200ee" required />
                </div>
                <div class="form-group form-actions">
                  <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
              </form>
            </div>

            <div class="card">
              <h2 class="card-title">Categorias</h2>
              <div id="grid-categories" class="grid-categories"></div>
            </div>
          </section>

          <!-- Metas -->
          <section id="page-goals" class="page hidden">
            <div class="card">
              <h2 class="card-title">Meta Mensal de Gastos</h2>
              <form id="form-monthly-goal" class="form-grid small">
                <div class="form-group">
                  <label for="goal-amount">Valor da Meta (R$)</label>
                  <input id="goal-amount" name="amount" type="number" min="0.01" step="0.01" required />
                </div>
                <div class="form-group form-actions">
                  <button type="submit" class="btn btn-primary">Atualizar</button>
                </div>
              </form>
            </div>

            <div class="card">
              <h2 class="card-title">Meta por Categoria</h2>
              <form id="form-category-goal" class="form-grid">
                <div class="form-group">
                  <label for="goal-category">Categoria</label>
                  <select id="goal-category" name="categoryId" required></select>
                </div>
                <div class="form-group">
                  <label for="goal-cat-amount">Valor da Meta (R$)</label>
                  <input id="goal-cat-amount" name="amount" type="number" min="0.01" step="0.01" required />
                </div>
                <div class="form-group form-actions">
                  <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
              </form>

              <div id="list-category-goals" class="grid-category-goals"></div>
            </div>
          </section>
          <!-- Bancos -->
          <section id="page-banks" class="page hidden">
            <div class="card">
              <h2 class="card-title">Novo Banco</h2>
              <form id="form-bank" class="form-grid small">
                <div class="form-group">
                  <label for="bank-name">Nome</label>
                  <input id="bank-name" name="name" type="text" required />
                </div>
                <div class="form-group form-actions">
                  <button type="submit" class="btn btn-primary">Adicionar</button>
                </div>
              </form>
            </div>

            <div class="card">
              <h2 class="card-title">Bancos</h2>
              <div id="grid-banks" class="grid-categories"></div>
            </div>
          </section>

        </main>
      </div>
    </div>

    <!-- FAB (Ações rápidas) -->
    <div class="fab-container" aria-label="Ações rápidas">
      <button class="fab-main" aria-label="Abrir ações">+</button>

    </div>

    <div id="drawer-overlay" class="drawer-overlay"></div>
    <script src="assets/js/app.js"></script>
    <script type="module" src="assets/js/main.js"></script>
     <script>
      // Registro do Service Worker sem interferir na lógica existente
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js').catch(() => {});
        });
      }
    </script>
  </body>
</html>